# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

**Repository**: https://github.com/ashrafatintuitive/tayyab-podcast-landing  
**Domain**: https://themuslimnonprofitshow.com

## Project Overview

This is a dynamic landing page for "The Muslim Non-Profit Show" podcast with an integrated PHP-based CRM system. The site combines a static frontend with a content management system for episode and website content management.

## Development Commands

```bash
# Start development server (uses Python 3's HTTP server)
npm run dev
# or
npm start

# Alternative development server (uses npx serve)
npm run serve
# or
npm run preview
```

## Architecture

The project consists of two main parts:

### Frontend (Static Site)
- **index.html** - Single page application entry point
- **css/styles.css** - All styling with modern CSS features (grid, flexbox, custom properties, glass morphism)
- **js/main.js** - Core application logic in `PodcastWebsite` class with dynamic content population
- **js/episodes.js** - Episode data (auto-generated by CRM)
- **js/website-data.js** - Website content data (auto-generated by CRM)

### Backend CRM System
- **podcast-crm/** - Complete content management system
- **podcast-crm/admin/** - Admin interface for content management
- **podcast-crm/api/** - REST API endpoints and database operations
- **podcast-crm/config/** - Configuration and database settings
- **podcast-crm/data/** - SQLite database and content JSON files

## Key Architectural Patterns

- **Hybrid Static/Dynamic**: Static frontend with CRM-managed content
- **Content Management**: All content (episodes, hero, stats, mission, social, meta) managed through CRM
- **Auto-Export System**: CRM exports data to JavaScript files for frontend consumption
- **RSS Feed Integration**: Automatic episode sync from Libsyn RSS feed
- **Mobile-First Design**: Responsive with glass morphism effects

## Content Management Workflow

### ✅ PREFERRED METHOD: Use the CRM

1. **Access CRM**: Go to `https://themuslimnonprofitshow.com/podcast-crm/admin/`
2. **Login**: Username: `admin`, Password: [set during setup]
3. **Manage Content**: 
   - Episodes: Add, edit, delete episodes with full metadata
   - Website Content: Edit hero section, stats, mission, social links, meta tags
4. **Export**: Click "Export All" to update the website
5. **RSS Sync**: Click "Sync Sources" to import new episodes from RSS feed

### Data Flow: CRM → Website

```
CRM Database → Export Functions → JavaScript Files → Website Display
     ↓              ↓                    ↓              ↓
Episodes Table → export.php → js/episodes.js → Episode Player
Content JSONs → export-content.php → js/website-data.js → Dynamic Content
```

## CRM System Components

### Database Tables
- **episodes**: Episode metadata, content, and publishing status
- **sync_log**: RSS feed sync history and error tracking

### Content Management Areas
- **Hero Section**: Badge, title, byline, description, CTA buttons
- **Stats**: Episode count, downloads, rating, countries  
- **Mission**: Title and content
- **Social Links**: All podcast platform URLs
- **Meta Tags**: SEO title, description, keywords

### API Endpoints
- `POST /api/episodes` - CRUD operations for episodes
- `POST /api/sync` - RSS feed synchronization
- `POST /api/export` - Export episodes to JavaScript
- `POST /api/export-all` - Export all content (episodes + website data)
- `GET/POST /api/website-content` - Manage website content sections

## RSS Feed Configuration

**Current RSS URL**: `https://feeds.libsyn.com/580735/rss` (Libsyn)  
**Source**: Apple Podcasts feed URL  
**Sync Method**: Manual via "Sync Sources" button or API call

To change RSS feed:
1. Update `RSS_FEED_URL` in `podcast-crm/config/config.php`
2. Test feed accessibility
3. Run sync to import episodes

## Standard Operating Procedures

### Adding New Episodes (CRM Method - RECOMMENDED)

1. **Via RSS Sync** (Automatic):
   - Click "Sync Sources" in CRM admin
   - Review imported episodes 
   - Edit details, add key takeaways, set featured status
   - Change status from "draft" to "published"
   - Click "Export All"

2. **Manual Entry**:
   - Click "New Episode" in CRM admin
   - Fill all fields: title, description, guest info, YouTube ID, audio URL
   - Add tags (comma-separated) and key takeaways
   - Set featured status (only one episode should be featured)
   - Save as "published"
   - Click "Export All"

### Updating Website Content

1. **Access CRM**: `https://themuslimnonprofitshow.com/podcast-crm/admin/`
2. **Edit Content Sections**: Click on any content area to edit
3. **Save Changes**: Content saves automatically
4. **Export**: Click "Export All" to update website
5. **Verify**: Check website to confirm changes

### Database Initialization

If database needs to be reset or initialized:
```bash
# Use the initialization script
https://themuslimnonprofitshow.com/podcast-crm/simple-init.php?key=init123
```

### Troubleshooting

**Episodes not showing on website:**
1. Check episode status is "published" in CRM
2. Click "Export All" in admin panel
3. Clear browser cache
4. Verify `js/episodes.js` was updated (check timestamp)

**Content not updating:**
1. Verify content was saved in CRM
2. Click "Export All" 
3. Check `js/website-data.js` for updates
4. Clear browser cache

**RSS Sync failing:**
1. Check RSS feed URL in config
2. Verify server can access external URLs
3. Check sync logs in CRM for error details

## File Structure

```
├── index.html                 # Main landing page
├── css/styles.css            # All styling  
├── js/
│   ├── main.js              # Core app logic + dynamic content population
│   ├── episodes.js          # Episodes data (CRM-generated)
│   └── website-data.js      # Website content (CRM-generated)
├── podcast-crm/             # Content Management System
│   ├── admin/              # Admin interface
│   │   ├── index.html      # Admin dashboard
│   │   ├── app.js          # Admin functionality
│   │   └── style.css       # Admin styling
│   ├── api/                # Backend API
│   │   ├── index.php       # Main API router
│   │   ├── db.php          # Database connection
│   │   ├── export.php      # Episodes export
│   │   ├── export-content.php # Website content export
│   │   └── sync.php        # RSS feed sync
│   ├── config/             # Configuration
│   │   └── config.php      # Database and settings
│   └── data/               # Data storage
│       ├── podcast.db      # SQLite database
│       ├── hero_content.json
│       ├── stats_content.json
│       ├── mission_content.json
│       ├── social_content.json
│       ├── meta_content.json
│       └── footer_content.json
```

## Security Notes

- CRM requires authentication for all operations
- Password is bcrypt hashed in config
- Database is SQLite with write permissions required
- RSS feed uses HTTPS with certificate verification disabled for compatibility

## Deployment

### Frontend (Static)
- Deploy entire repository to static hosting
- No build process required
- Update cache-busting version in index.html when needed

### CRM (PHP Required)
- Requires PHP 7.4+ with SQLite support
- Set write permissions on `podcast-crm/data/` directory
- Configure database path in config.php
- Secure admin access with strong password

## Important Implementation Details

1. **Dynamic Content**: Website content is populated from `websiteData` object via `populateWebsiteContent()` method
2. **Episode Management**: Episodes displayed via `EpisodeManager` utilities from auto-generated data
3. **Export System**: Two export functions work together - episodes and website content
4. **Cache Busting**: JavaScript files use version parameters for cache control
5. **Responsive Design**: Mobile-first with glass morphism effects

## IMPORTANT: Sound Notification

After finishing responding to my request or running a command, run this command to notify me by sound:

```bash
afplay /System/Library/Sounds/Funk.aiff
```